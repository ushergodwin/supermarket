class BLFILEUPLOAD{constructor(){this.upload()}upload(){$(".bl-file-upload").on("submit",e=>{function uploadError(){-1!==$(".feedBack").text().search("Failure")?($(".progress-bar").removeClass("bg-success"),$(".progress-bar").addClass("bg-warning"),$(".perc").text("0% Upload Failed")):($(".progress-bar").addClass("bg-success"),$(".progress-bar").removeClass("bg-warning"))}function hasAttr(){let attr=$(".bl-file-upload").attr("data-url");return void 0!==attr&&!1!==attr}e.preventDefault();let formData=new FormData($(".bl-file-upload")[0]);if($("div").is(".bl-file-upload-response")){$(".bl-file-upload-response").html('<div class="progress" style="display:none;"><div class="progress-bar bg-success progress-bar-striped active" role="progressbar" style="width: 0%" aria-valuenow="100" aria-valuemin="50" aria-valuemax="100"> <span class="perc">0%</span></div></div>'),$("<div class='feedBack'></div>").insertAfter(".bl-file-upload-response");let request_method=$(".bl-file-upload").attr("method");if(!hasAttr())return alert("The form should have an attribute data-url defining where to send the request."),!1;{let upload_url=$(".bl-file-upload").data("url");$.ajax({xhr:function(){var xhr=new window.XMLHttpRequest;return xhr.upload.addEventListener("progress",(function(evt){if(evt.lengthComputable){var percentComplete=Math.round(100*evt.loaded/evt.total);$(".progress").show(),$(".progress-bar").css({width:percentComplete+"%"}),$(".perc").text(percentComplete+"% Complete")}}),!1),xhr},url:upload_url,type:request_method,data:formData,contentType:!1,processData:!1,beforeSend:()=>{$(".upload-btn").html("<i class='fa fa-spinner fa-spin '></i> Uploading...")},success:response=>{$(".feedBack").html(response),uploadError()},complete:()=>{$(".upload-btn").html("<i class='fa fa-arrow-circle-up'></i> Upload ")}})}}else alert("There is no response element definded. Please create a div with class 'bl-file-upload-response' and try again!")})}}